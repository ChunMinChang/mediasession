<!doctype html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  
  
  <title>Media Session Standard</title>
  
  
  <link href="https://www.whatwg.org/style/specification" rel="stylesheet">
  
  
  <link href="https://resources.whatwg.org/bikeshed.css" rel="stylesheet">
  
  
  <link href="https://resources.whatwg.org/logo.svg" rel="icon">
  

  <meta content="Bikeshed 1.0.0" name="generator">
  <style>/* http://prismjs.com/download.html?themes=prism&languages=clike */
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', monospace;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #a67f59;
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important {
	font-weight: bold;
}

.token.entity {
	cursor: help;
}
</style>
 </head>
 <body class="h-entry status-LS">

  <div class="head">
  
   <p data-fill-with="logo"><a class="logo" href="https://whatwg.org/">
    <img alt="WHATWG" height="100" src="https://resources.whatwg.org/logo.svg">
</a>
</p>
  
   <h1 class="p-name no-ref" id="title">Media Session</h1>
  
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Living Standard â€” Last Updated
    <time class="dt-updated" datetime="2015-05-12">12 May 2015</time></span></h2>
  
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>Participate:
     <dd><span><a href="https://github.com/whatwg/mediasession/issues/new">File an issue</a> (<a href="https://github.com/whatwg/mediasession/issues?state=open">open issues</a>)</span>
     <dd><span><a href="https://wiki.whatwg.org/wiki/IRC">IRC: #whatwg on Freenode</a></span>
     <dt>Version History:
     <dd><span><a href="https://github.com/whatwg/mediasession/commits">https://github.com/whatwg/mediasession/commits</a></span>
    </dl>
   </div>
  
   <div data-fill-with="warning"></div>
</div>
  


  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  

  <div class="p-summary" data-fill-with="abstract">
   <p>This specification enables web developers to obtain different levels

of platform media focus and implicit access to platform media keys
such as hardware keys found on keyboards, headsets, remote controls,
and software keys found in notification areas and on lock screens of
mobile devices.</p>

</div>
  

  <div data-fill-with="at-risk"></div>
  


  <h2 class="no-num no-toc no-ref heading settled" id="contents"><span class="content">Table of Contents</span></h2>
  

  <div data-fill-with="table-of-contents" role="navigation">
   <ul class="toc" role="directory">
    <li><a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li><a href="#conformance"><span class="secno">2</span> <span class="content">Conformance</span></a>
    <li><a href="#dependencies"><span class="secno">3</span> <span class="content">Dependencies</span></a>
    <li><a href="#media-categories"><span class="secno">4</span> <span class="content">Media categories</span></a>
    <li><a href="#media-sessions"><span class="secno">5</span> <span class="content">Media sessions</span></a>
    <li><a href="#assigning-a-media-category-to-media-elements"><span class="secno">6</span> <span class="content">Assigning a media category
to media elements</span></a>
     <ul class="toc">
      <li><a href="#extensions-to-the-htmlmediaelement-interface"><span class="secno">6.1</span> <span class="content">Extensions to the
<code class="idl"><span>HTMLMediaElement</span></code> interface</span></a>
      <li><a href="#extensions-to-the-video-element"><span class="secno">6.2</span> <span class="content">Extensions to the <code><span>video</span></code> element</span></a>
      <li><a href="#extensions-to-the-audio-element"><span class="secno">6.3</span> <span class="content">Extensions to the <code><span>audio</span></code> element</span></a>
     </ul>
    <li><a href="#media-session-invocation"><span class="secno">7</span> <span class="content">Media session invocation</span></a>
    <li><a href="#media-session-interruption"><span class="secno">8</span> <span class="content">Media session interruption</span></a>
    <li><a href="#media-session-release"><span class="secno">9</span> <span class="content">Media session release</span></a>
    <li><a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ul class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ul>
    <li><a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ul class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ul>
   </ul></div>
  

  <main>





   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>


   <p><em>This section is non-normative.</em></p>


   <p>Media is used extensively today on the web to play a variety of different types
of content. It is often used to play music, podcasts and radio content. At other
times media elements are used to provide background music, sound effects,
notification sounds and to render WebRTC media stream content.</p>


   <p>When playing media on the web, developers are currently forced to adopt a single
default platform modality for playing all media content. On the other hand,
native applications can access much richer media integration options with an
underlying platform. On mobile devices, native application developers can
request many different forms of media integration with the platform to obtain
access to headphone buttons, lock screens and notification areas as needed. On
desktop devices, native applications have access to keyboard media key events.
Native application developers can specify the conditions in which media content
should pause or duck on audio interruptions (i.e. pause or lower the volume for
the duration of an interruption), continue playing out when application focus is
lost or the device screen is switched off and interface with internal and
external remote controllers.</p>


   <p>This specification provides these platform media integration features for web
media. By allowing web developers to express the intended usage of their media
content, user agents can supply the most suitable platform-level interactions
for that content and enforce logical inter-operation behavior on the current
platform between any number of different sources of media.</p>


   <p>This specification describes the mechanism that allows web developers to specify
the most appropriate category for their media content and for user agents to
then use these supplied hints to enforce how different sources of web media
should interact with each other, other native media content and the underlying
platform.</p>


   <h2 class="heading settled" data-level="2" id="conformance"><span class="secno">2. </span><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>


   <p>All diagrams, examples, and notes in this specification are non-normative, as
are all sections explicitly marked non-normative. Everything else in this
specification is normative.</p>


   <p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in RFC 2119. For readability, these
words do not appear in all uppercase letters in this specification. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>


   <p>Requirements phrased in the imperative as part of algorithms (such as "strip any
leading space characters" or "return false and terminate these steps") are to be
interpreted with the meaning of the key word ("must", "should", "may", etc) used
in introducing the algorithm.</p>


   <p>Conformance requirements phrased as algorithms or specific steps may be
implemented in any manner, so long as the end result is equivalent. (In
particular, the algorithms defined in this specification are intended to be easy
to follow, and not intended to be performant.)</p>


   <p>User agents may impose implementation-specific limits on otherwise unconstrained
inputs, e.g. to prevent denial of service attacks, to guard against running out
of memory, or to work around platform-specific limitations.</p>


   <p>When a method or an attribute is said to call another method or attribute, the
user agent must invoke its internal API for that attribute or method so that
e.g. the author canâ€™t change the behavior by overriding attributes or methods
with custom properties or functions in JavaScript.</p>


   <p>Unless otherwise stated, string comparisons are done in a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#case-sensitivity-and-string-comparison">case-sensitive</a>
manner.</p>


   <h2 class="heading settled" data-level="3" id="dependencies"><span class="secno">3. </span><span class="content">Dependencies</span><a class="self-link" href="#dependencies"></a></h2>


   <p>The IDL fragments in this specification must be interpreted as required for
conforming IDL fragments, as described in the Web IDL specification. <a data-link-type="biblio" href="#biblio-webidl">[WEBIDL]</a></p>


   <h2 class="heading settled" data-level="4" id="media-categories"><span class="secno">4. </span><span class="content">Media categories</span><a class="self-link" href="#media-categories"></a></h2>


   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="media-category">media category<a class="self-link" href="#media-category"></a></dfn> is a keyword that maps to a well-defined interaction
state for a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> that user agents use to enforce
platform-specific interaction and interoperation between web media.</p>


   <p>The following table lists the available <a data-link-type="dfn" href="#media-category">media categories</a> keywords and
states â€” the keywords in the left column map to the states in the cell in the
second column on the same row as the keyword. The attribute should be set based
on the preferred definitions in the tableâ€™s third and fourth columns.</p>


   <table id="valid-media-categories">
  
    <tbody>
     <tr>
    
      <th>Category
      
    
      <th>State
      
    
      <th>Definition
      
    
      <th>Examples
      
  
     
  
     <tr>
    
      <td>
      "<dfn data-dfn-type="dfn" data-lt="content attribute value" data-noexport="" id="content-attribute-value"><code>content</code><a class="self-link" href="#content-attribute-value"></a></dfn>"
    
      
    
      <td>
      <dfn data-dfn-type="dfn" data-lt="content media state" data-noexport="" id="content-media-state">Content<a class="self-link" href="#content-media-state"></a></dfn>
    
      
    
      <td>
      
       <ul>
        
        <li>
          Indefinitely pauses all other <a data-link-type="dfn" href="#active-media-session-state">active</a>
          <code><a data-link-type="dfn" href="#default-media-state">Default</a></code> and <code><a data-link-type="dfn" href="#content-media-state">Content</a></code> content when <a href="#media-session-invocation">playback begins</a>.
        
        
        
        <li>
          Displays lock-screen and notification area user interfaces when
          <a href="#media-session-invocation">playback begins</a>.
        
        
        
        <li>
          Reacts to changes in both hardware and software-based media key
          buttons when <a href="#media-session-invocation">playback begins</a>.
        
        
        
        <li>
          Ducks itself when <code><a data-link-type="dfn" href="#transient-mixable-media-state">Transient_Mixable</a></code> content <a href="#media-session-interruption">starts interrupting</a>. Unducks
          itself when <code><a data-link-type="dfn" href="#transient-mixable-media-state">Transient_Mixable</a></code> content <a href="#media-session-release">ends playback</a>.
        
        
        
        <li>
          Pauses itself when <code><a data-link-type="dfn" href="#transient-exclusive-media-state">Transient_Exclusive</a></code> content <a href="#media-session-interruption">starts interrupting</a>. Unpauses
          itself when <code><a data-link-type="dfn" href="#transient-exclusive-media-state">Transient_Exclusive</a></code> content <a href="#media-session-release">ends playback</a>.
        
        
        
        <li>
          Continues playing normally when <code><a data-link-type="dfn" href="#ambient-media-state">Ambient</a></code> content <a href="#media-session-interruption">starts interrupting</a>.
        
        
      
       </ul>
       
    
      
    
      <td>
      Music, podcasts, radio streams.
    
      
  
     
  
     <tr>
    
      <td>
      "<dfn data-dfn-type="dfn" data-lt="transient attribute
      value" data-noexport="" id="transient-attribute-value"><code>transient</code><a class="self-link" href="#transient-attribute-value"></a></dfn>"
    
      
    
      <td>
      <dfn data-dfn-type="dfn" data-lt="transient mixable media state" data-noexport="" id="transient-mixable-media-state">Transient_Mixable<a class="self-link" href="#transient-mixable-media-state"></a></dfn>
    
      
    
      <td>
      
       <ul>
        
        <li>
          Ducks all other <a data-link-type="dfn" href="#active-media-session-state">active</a> <code><a data-link-type="dfn" href="#default-media-state">Default</a></code>
          and <code><a data-link-type="dfn" href="#content-media-state">Content</a></code> content when
          <a href="#media-session-invocation">playback begins</a>. Unducks all
          other <a data-link-type="dfn" href="#interrupted-media-session-state">interrupted</a> <code><a data-link-type="dfn" href="#default-media-state">Default</a></code> and <code><a data-link-type="dfn" href="#content-media-state">Content</a></code> content when <a href="#media-session-release">playback ends</a>.
        
        
        
        <li>
          Does not display lock-screen and notification area user interfaces
          when <a href="#media-session-invocation">playback begins</a>.
        
        
        
        <li>
          Does not react to changes in both hardware and software-based media
          key buttons when <a href="#media-session-invocation">playback
          begins</a>.
        
        
        
        <li>
          Pauses itself when <code><a data-link-type="dfn" href="#transient-exclusive-media-state">Transient_Exclusive</a></code> content <a href="#media-session-interruption">starts interrupting</a>. Unpauses
          itself when <code><a data-link-type="dfn" href="#transient-exclusive-media-state">Transient_Exclusive</a></code> content <a href="#media-session-release">ends playback</a>.
        
        
        
        <li>
          Continues playing normally when other <code><a data-link-type="dfn" href="#transient-mixable-media-state">Transient_Mixable</a></code> or <code><a data-link-type="dfn" href="#ambient-media-state">Ambient</a></code> content <a href="#media-session-interruption">starts interrupting</a>.
        
        
      
       </ul>
       
    
      
    
      <td>
      Notification sounds. Spoken driving directions where playback of music in
      the background is acceptable.
    
      
  
     
  
     <tr>
    
      <td>
      "<dfn data-dfn-type="dfn" data-lt="transientsolo attribute
      value" data-noexport="" id="transientsolo-attribute-value"><code>transientsolo</code><a class="self-link" href="#transientsolo-attribute-value"></a></dfn>"
    
      
    
      <td>
      <dfn data-dfn-type="dfn" data-lt="transient exclusive media state" data-noexport="" id="transient-exclusive-media-state">Transient_Exclusive<a class="self-link" href="#transient-exclusive-media-state"></a></dfn>
    
      
    
      <td>
      
       <ul>
        
        <li>
          Pauses all other <a data-link-type="dfn" href="#active-media-session-state">active</a>
          <code><a data-link-type="dfn" href="#default-media-state">Default</a></code>,
          <code><a data-link-type="dfn" href="#content-media-state">Content</a></code>, <code><a data-link-type="dfn" href="#transient-mixable-media-state">Transient_Mixable</a></code> and
          <code><a data-link-type="dfn" href="#transient-exclusive-media-state">Transient_Exclusive</a></code> content when <a href="#media-session-invocation">playback begins</a>. Unpauses all <a data-link-type="dfn" href="#interrupted-media-session-state">interrupted</a>
          <code><a data-link-type="dfn" href="#default-media-state">Default</a></code>, <code><a data-link-type="dfn" href="#content-media-state">Content</a></code>, <code><a data-link-type="dfn" href="#transient-mixable-media-state">Transient_Mixable</a></code> and <code><a data-link-type="dfn" href="#transient-exclusive-media-state">Transient_Exclusive</a></code>
          content when <a href="#media-session-release">playback ends</a>.
        
        
        
        <li>
          Does not display lock-screen and notification area user interfaces
          when <a href="#media-session-invocation">playback begins</a>.
        
        
        
        <li>
          Does not react to changes in both hardware and software-based media
          key buttons when <a href="#media-session-invocation">playback
          begins</a>.
        
        
        
        <li>
          Pauses itself when other <code><a data-link-type="dfn" href="#transient-exclusive-media-state">Transient_Exclusive</a></code> content <a href="#media-session-interruption">starts interrupting</a>. Unpauses
          itself when other <code><a data-link-type="dfn" href="#transient-exclusive-media-state">Transient_Exclusive</a></code> content <a href="#media-session-release">ends playback</a>.
        
        
        
        <li>
          Continues playing normally when <code><a data-link-type="dfn" href="#ambient-media-state">Ambient</a></code> content <a href="#media-session-interruption">starts interrupting</a>.
        
        
      
       </ul>
       
    
      
    
      <td>
      Playback of driving directions. Other spoken notifications.
    
      
  
     
  
     <tr>
    
      <td>
      "<dfn data-dfn-type="dfn" data-lt="ambient attribute value" data-noexport="" id="ambient-attribute-value"><code>ambient</code><a class="self-link" href="#ambient-attribute-value"></a></dfn>"
    
      
    
      <td>
      <dfn data-dfn-type="dfn" data-lt="ambient media state" data-noexport="" id="ambient-media-state">Ambient<a class="self-link" href="#ambient-media-state"></a></dfn>
    
      
    
      <td>
      
       <ul>
        
        <li>
          Does not interact with any other <code><a data-link-type="dfn" href="#default-media-state">Default</a></code>,
          <code><a data-link-type="dfn" href="#content-media-state">Content</a></code>, <code><a data-link-type="dfn" href="#transient-mixable-media-state">Transient_Mixable</a></code>,
          <code><a data-link-type="dfn" href="#transient-exclusive-media-state">Transient_Exclusive</a></code> or <code><a data-link-type="dfn" href="#ambient-media-state">Ambient</a></code> content during playback.
        
        
        
        <li>
          Does not display lock-screen and notification area user interfaces
          when <a href="#media-session-invocation">playback begins</a>.
        
        
        
        <li>
          Does not react to changes in both hardware and software-based media
          key buttons when <a href="#media-session-invocation">playback
          begins</a>.
        
        
        
        <li>
          Pauses itself when its <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context">browsing context</a> loses focus (i.e. the
          page is placed in the background or the user agent is minimized or the
          screen is switched off). Unpauses itself when its <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context">browsing
          context</a> re-gains focus (i.e. the user agent is in the foreground
          and the page is visible again).
        
        
      
       </ul>
       
    
      
    
      <td>
      UI sounds. In-game sound effects.
    
      
  
     
  
     <tr>
    
      <td>
      "<strong id="default-media-value"><code></code></strong>" (empty
      string)
    
      
    
      <td>
      <dfn data-dfn-type="dfn" data-lt="default media state" data-noexport="" id="default-media-state">Default<a class="self-link" href="#default-media-state"></a></dfn>
    
      
    
      <td>
      
       <ul>
        
        <li>
          No explicit kind, or the kind of the media given is not recognized by
          the user agent.
        
        
      
       </ul>
       
    
      
    
      <td>
      Legacy media content
    
      
  
     
</table>


   <h2 class="heading settled" data-level="5" id="media-sessions"><span class="secno">5. </span><span class="content">Media sessions</span><a class="self-link" href="#media-sessions"></a></h2>


   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="media-session">media session<a class="self-link" href="#media-session"></a></dfn> represents one or more <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media elements</a> within
the same <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">top-level browsing context</a> that share the same <a data-link-type="dfn" href="#media-category">media
category</a>. Each <a data-link-type="dfn" href="#media-session">media session</a> then defines the interactions of those
<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media elements</a> with both the underlying platform and other <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media
elements</a> belonging to other <a data-link-type="dfn" href="#media-session">media sessions</a> within the user agent.</p>


   <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> can have a <dfn data-dfn-type="dfn" data-noexport="" id="current-media-session">current media session<a class="self-link" href="#current-media-session"></a></dfn>, which is a
<a data-link-type="dfn" href="#media-session">media session</a>. When a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> is created it does not have a
<a data-link-type="dfn" href="#current-media-session">current media session</a>.</p>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="participating-media-elements">participating media elements<a class="self-link" href="#participating-media-elements"></a></dfn> of a <a data-link-type="dfn" href="#media-session">media session</a> are the
<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media elements</a> whose <a data-link-type="dfn" href="#current-media-session">current media session</a> is that
<a data-link-type="dfn" href="#media-session">media session</a>.</p>


   <p><a data-link-type="dfn" href="#media-session">Media sessions</a> have a <dfn data-dfn-type="dfn" data-noexport="" id="current-state">current state<a class="self-link" href="#current-state"></a></dfn>, which describes their
current status with respect to any interaction with other <a data-link-type="dfn" href="#media-session">media sessions</a>.
The possible values are as follows:</p>


   <dl>
  
    <dt>
    <dfn data-dfn-type="dfn" data-lt="idle media session state" data-noexport="" id="idle-media-session-state"><code>IDLE</code><a class="self-link" href="#idle-media-session-state"></a></dfn>
  
  
    <dd>
    The <a data-link-type="dfn" href="#media-session">media session</a> does not have any platform-level media focus nor is
    it in a suspended state.
  
  
    <dt>
    <dfn data-dfn-type="dfn" data-lt="active media session state" data-noexport="" id="active-media-session-state"><code>ACTIVE</code><a class="self-link" href="#active-media-session-state"></a></dfn>
  
  
    <dd>
    The <a data-link-type="dfn" href="#media-session">media session</a> currently has platform-level media focus.
  
  
    <dt>
    <dfn data-dfn-type="dfn" data-lt="interrupted media session state" data-noexport="" id="interrupted-media-session-state"><code>INTERRUPTED</code><a class="self-link" href="#interrupted-media-session-state"></a></dfn>
  
  
    <dd>
    The <a data-link-type="dfn" href="#media-session">media session</a> is currently suspended from having platform-level
    media focus and its <a data-link-type="dfn" href="#participating-media-elements">participating media elements</a> are either paused or
    ducked based on the <a data-link-type="dfn" href="#media-session">media session</a>â€™s <a data-link-type="dfn" href="#media-category">media category</a> and pending
    completion of another <a data-link-type="dfn" href="#media-session">media session</a>â€™s media focus.
  
</dl>


   <p>Â </p>


   <p>When a <a data-link-type="dfn" href="#media-session">media session</a> is created its <a data-link-type="dfn" href="#current-state">current state</a> must be
initially set to
<code><a data-link-type="dfn" href="#idle-media-session-state">IDLE</a></code>.</p>


   <p>When the <a data-link-type="dfn" href="#media-session-invocation-algorithm">media session invocation algorithm</a> is run a <a data-link-type="dfn" href="#media-session">media
session</a>â€™s <a data-link-type="dfn" href="#current-state">current state</a> may be set from <code><a data-link-type="dfn" href="#idle-media-session-state">IDLE</a></code> to
<code><a data-link-type="dfn" href="#active-media-session-state">ACTIVE</a></code>.</p>


   <p>When the <a data-link-type="dfn" href="#media-session-interruption-algorithm">media session interruption algorithm</a> is run a <a data-link-type="dfn" href="#media-session">media
session</a>â€™s <a data-link-type="dfn" href="#current-state">current state</a> may be set from
<code><a data-link-type="dfn" href="#active-media-session-state">ACTIVE</a></code> to either <code><a data-link-type="dfn" href="#idle-media-session-state">IDLE</a></code> or <code><a data-link-type="dfn" href="#interrupted-media-session-state">INTERRUPTED</a></code> depending on its associated <a data-link-type="dfn" href="#media-category">media
category</a>.</p>


   <p>When the <a data-link-type="dfn" href="#media-session-release-algorithm">media session release algorithm</a> is run a <a data-link-type="dfn" href="#media-session">media session</a>â€™s
<a data-link-type="dfn" href="#current-state">current state</a>
may be set from <code><a data-link-type="dfn" href="#active-media-session-state">ACTIVE</a></code> to
<code><a data-link-type="dfn" href="#idle-media-session-state">IDLE</a></code>. Any <a data-link-type="dfn" href="#interrupted-media-session-state">interrupted</a> <a data-link-type="dfn" href="#media-session">media sessions</a> may then be set from
<code><a data-link-type="dfn" href="#interrupted-media-session-state">INTERRUPTED</a></code>
to <code><a data-link-type="dfn" href="#active-media-session-state">ACTIVE</a></code> during this
algorithm.</p>



   <h2 class="heading settled" data-level="6" id="assigning-a-media-category-to-media-elements"><span class="secno">6. </span><span class="content">Assigning a media category
to media elements</span><a class="self-link" href="#assigning-a-media-category-to-media-elements"></a></h2>


   <h3 class="heading settled" data-level="6.1" id="extensions-to-the-htmlmediaelement-interface"><span class="secno">6.1. </span><span class="content">Extensions to the
<code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#htmlmediaelement">HTMLMediaElement</a></code> interface</span><a class="self-link" href="#extensions-to-the-htmlmediaelement-interface"></a></h3>


   <pre class="idl">partial interface <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/embedded-content.html#htmlmediaelement">HTMLMediaElement</a> {
  attribute DOMString <a class="idl-code" data-global-name="HTMLMediaElement<interface>/kind<attribute>" data-link-type="attribute" data-type="DOMString " href="#dom-htmlmediaelement-kind">kind</a>;
};
</pre>


   <dl class="domintro">
  
    <dt>
    <code><var>media</var> . <code class="idl"><a data-link-type="idl" href="#dom-htmlmediaelement-kind">kind</a></code></code>
  
  
    <dd>
    Returns the category the given media falls into. The <a href="#valid-media-categories">possible media categories</a> are defined
    above.
  
</dl>


   <p>The <dfn class="idl-code" data-dfn-for="HTMLMediaElement" data-dfn-type="attribute" data-export="" id="dom-htmlmediaelement-kind"><code>kind</code><a class="self-link" href="#dom-htmlmediaelement-kind"></a></dfn> IDL
attribute is intended to provide a hint to the user agent about what the author
thinks will lead to the best user experience for media playback. The attribute
may be ignored altogether, for example based on explicit user preferences or
based on the capabilities of the underlying platform.</p>


   <p>The <code><code class="idl"><a data-link-type="idl" href="#dom-htmlmediaelement-kind">kind</a></code></code> IDL attribute can be changed even
once the media resource is being played; but it is only read by the platform at
the point that the <a data-link-type="dfn" href="#media-session-invocation-algorithm">media session invocation algorithm</a> is run against a
<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a>. Thus, changing this attribute once the media element is
<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#potentially-playing">potentially playing</a> does not dynamically change the <a data-link-type="dfn" href="#media-session">media session</a>
to which the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> belongs.</p>


   <p>The <code><code class="idl"><a data-link-type="idl" href="#dom-htmlmediaelement-kind">kind</a></code></code> IDL attribute must
<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#reflect">reflect</a> the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#video">video</a></code> and <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#audio">audio</a></code> element content attribute of the same name, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#limited-to-only-known-values">limited
to only known values</a>.</p>


   <div class="example" id="example-30f38a54"><a class="self-link" href="#example-30f38a54"></a>
  As both <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#audio">audio</a></code> and <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#video">video</a></code>
  elements implement the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#htmlmediaelement">HTMLMediaElement</a></code> interface, these elementâ€™s
  <code class="idl"><a data-link-type="idl" href="#dom-htmlmediaelement-kind">kind</a></code> IDL attribute can be set via JavaScript:

  
    <pre class="lang-javascript">var myAudio = document.createElement("audio");
console.log(myAudio.kind) // --> ""
myAudio.src = "music.mp3";
myAudio.kind = "content";
// myAudio.outerHTML === "&lt;audio src="music.mp3" kind="content">&lt;/audio>" === true
</pre>
</div>


   <div class="example" id="example-fb4b5847"><a class="self-link" href="#example-fb4b5847"></a>
  An <code class="idl"><a data-link-type="idl" href="http://webaudio.github.io/web-audio-api/#audiocontext">AudioContext</a></code> object <a data-link-type="biblio" href="#biblio-webaudio">[WEBAUDIO]</a> can be rendered via <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#audio">audio</a></code> or <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#video">video</a></code>
  elements. As both <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#audio">audio</a></code> and <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#video">video</a></code>
  elements implement the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#htmlmediaelement">HTMLMediaElement</a></code> interface, these elementâ€™s
  <code class="idl"><a data-link-type="idl" href="#dom-htmlmediaelement-kind">kind</a></code> IDL attribute can be set via JavaScript:

  
    <pre class="lang-javascript">var audioCtx = new AudioContext();
// ...
var destinationNode = audioCtx.createMediaStreamDestination();

var myAudio = document.createElement("audio");
console.log(myAudio.kind) // --> ""
myAudio.srcObject = destinationNode.stream;
myAudio.kind = "content";
// myAudio.outerHTML === "&lt;audio kind="content">&lt;/audio>" === true
</pre>

  
    <p class="note" role="note">
    Web developers should ensure that, when an <code class="idl"><a data-link-type="idl" href="http://webaudio.github.io/web-audio-api/#audiocontext">AudioContext</a></code> object is
    attached to an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#audio">audio</a></code> or <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#video">video</a></code>
    element, that they apply subsequent <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#event-media-pause">pause</a></code> and <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#event-media-play">play</a></code> events dispatched
    on that <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#audio">audio</a></code> or <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#video">video</a></code>
    element to their <code class="idl"><a data-link-type="idl" href="http://webaudio.github.io/web-audio-api/#audiocontext">AudioContext</a></code> object appropriately.
  </p>
</div>


   <h3 class="heading settled" data-level="6.2" id="extensions-to-the-video-element"><span class="secno">6.2. </span><span class="content">Extensions to the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#video">video</a></code> element</span><a class="self-link" href="#extensions-to-the-video-element"></a></h3>


   <dl class="element">
  
    <dt>
    Additional content attributes:
  
  
    <dd>
    <dfn data-dfn-type="dfn" data-lt="video kind" data-noexport="" id="video-kind"><code>kind</code><a class="self-link" href="#video-kind"></a></dfn> â€” The type of video
  
</dl>


   <p>The <code><a data-link-type="dfn" href="#video-kind">kind</a></code> content attribute on a
<code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#video">video</a></code> element is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enumerated-attribute">enumerated attribute</a>
and must return the video elementâ€™s <a data-link-type="dfn" href="#media-category">media category</a>, if it has one, or the
empty string otherwise.</p>


   <div class="example" id="example-bf865495"><a class="self-link" href="#example-bf865495"></a>
  A <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#video">video</a></code> elementâ€™s <code><a data-link-type="dfn" href="#audio-kind">kind</a></code> content attribute can be declared in as follows HTML:

  
    <pre class="lang-markup">&lt;video src="short_ping.webm" kind="transient">
</pre>
</div>


   <h3 class="heading settled" data-level="6.3" id="extensions-to-the-audio-element"><span class="secno">6.3. </span><span class="content">Extensions to the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#audio">audio</a></code> element</span><a class="self-link" href="#extensions-to-the-audio-element"></a></h3>


   <dl class="element">
  
    <dt>
    Additional content attributes:
  
  
    <dd>
    <dfn data-dfn-type="dfn" data-lt="audio kind" data-noexport="" id="audio-kind"><code>kind</code><a class="self-link" href="#audio-kind"></a></dfn> â€” The type of audio
  
</dl>


   <p>The <code><a data-link-type="dfn" href="#audio-kind">kind</a></code> content attribute on an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#audio">audio</a></code> element is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enumerated-attribute">enumerated attribute</a> and must
return the audio elementâ€™s <a data-link-type="dfn" href="#media-category">media category</a>, if it has one, or the empty
string otherwise.</p>


   <div class="example" id="example-bdfb2d3d"><a class="self-link" href="#example-bdfb2d3d"></a>
  An <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#audio">audio</a></code> elementâ€™s <code><a data-link-type="dfn" href="#audio-kind">kind</a></code> content attribute can be declared as follows in HTML:

  
    <pre class="lang-markup">&lt;audio src="track1.ogg" kind="content">
</pre>
</div>


   <h2 class="heading settled" data-level="7" id="media-session-invocation"><span class="secno">7. </span><span class="content">Media session invocation</span><a class="self-link" href="#media-session-invocation"></a></h2>


   <p>When the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-play">play()</a></code> method on a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> is invoked and the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media
element</a>â€™s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-paused">paused</a></code> attribute is true and the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a>â€™s
<code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-readystate">readyState</a></code> attribute has the value <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code> or
<code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-have_enough_data">HAVE_ENOUGH_DATA</a></code>, then the user agent must run the <a data-link-type="dfn" href="#media-session-invocation-algorithm">media session
invocation algorithm</a>, passing in the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> as
<var>current media element</var>. <a data-link-type="biblio" href="#biblio-html">[HTML]</a></p>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="media-session-invocation-algorithm">media session invocation algorithm<a class="self-link" href="#media-session-invocation-algorithm"></a></dfn> takes one argument,
<var>current media element</var>, and consists of the following steps:</p>


   <ol>
  
    <li>
    Let <var>media category state</var> be the <var>current media
    element</var>â€™s <code class="idl"><a data-link-type="idl" href="#dom-htmlmediaelement-kind">kind</a></code> attributeâ€™s state value as defined in the list of
    <a href="#valid-media-categories">possible media categories</a>. If no known
    category match is found, let <var>media category state</var> be <code><a data-link-type="dfn" href="#default-media-state">Default</a></code>.
  
  
    <li>
    Return and run the remaining steps asynchronously.
  
  
    <li>
    If <var>media category state</var> is <code><a data-link-type="dfn" href="#default-media-state">Default</a></code> then let <var>media session</var> be the current
    <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">top-level browsing context</a>â€™s <a data-link-type="dfn" href="#media-session">media session</a>. Otherwise, let
    <var>media session</var> be a new <a data-link-type="dfn" href="#media-session">media session</a> with <var>media
    category state</var> characteristics.
  
  
    <li>
    Set <var>current media element</var>â€™s <a data-link-type="dfn" href="#current-media-session">current media session</a> to
    <var>media session</var>.
  
  
    <li>
    If <var>media session</var>â€™s <a data-link-type="dfn" href="#current-state">current state</a> is
    <code><a data-link-type="dfn" href="#active-media-session-state">ACTIVE</a></code> abort any
    remaining steps and return.
  
  
    <li>
    Optionally, based on platform conventions, request the most appropriate
    platform-level media focus for <var>media session</var> based on the current
    <var>media category state</var>.


     <p>If this step is run and platform-level media focus can not be obtained for
    any reason then this algorithm must stall on this step.</p>
     
  
  
    <li>
    Set <var>media session</var>â€™s <a data-link-type="dfn" href="#current-state">current state</a> to
    <code><a data-link-type="dfn" href="#active-media-session-state">ACTIVE</a></code>.
  
  
    <li>
    Run these substeps:

    
     <dl class="switch">
      
      <dt>
        If <var>media category state</var> is <code><a data-link-type="dfn" href="#content-media-state">Content</a></code>
      
      
      
      <dd>
        
       <ol>
          
        <li>
            Optionally, based on platform conventions, the user agent may show
            an ongoing media interface in the underlying platformâ€™s
            notifications area and/or show an ongoing media interface in the
            underlying platformâ€™s lock screen area for <var>media session</var>.
          
        
          
        <li>
            Optionally, based on platform conventions, the user agent may allow
            hardware and/or software media keys to control playback of
            <var>media session</var>â€™s <a data-link-type="dfn" href="#participating-media-elements">participating media elements</a>.
          
        
        
       </ol>
       
      
      
      
      <dt>
        If <var>media category state</var> is <code><a data-link-type="dfn" href="#transient-mixable-media-state">Transient_Mixable</a></code>, <code><a data-link-type="dfn" href="#transient-exclusive-media-state">Transient_Exclusive</a></code> or <code><a data-link-type="dfn" href="#ambient-media-state">Ambient</a></code>
      
      
      
      <dd class="note" role="note">
        The user agent should not provide user access to any hardware or
        software media keys and not display any ongoing media interface in the
        underlying platformâ€™s notifications area or show any ongoing media
        interface in the underlying platformâ€™s lock screen area for
        <code><a data-link-type="dfn" href="#transient-mixable-media-state">Transient_Mixable</a></code>, <code><a data-link-type="dfn" href="#transient-exclusive-media-state">Transient_Exclusive</a></code> or <code><a data-link-type="dfn" href="#ambient-media-state">Ambient</a></code>-based <a data-link-type="dfn" href="#media-session">media sessions</a>.
      
      
      
      <dt>
        Otherwise, <var>media category state</var> is <code><a data-link-type="dfn" href="#default-media-state">Default</a></code>
      
      
      
      <dd class="note" role="note">
        @TBW


       <p>Different platforms (e.g. desktop vs. mobile) currently enforce
        different platform-level default behavior for media elements. Should we
        define a consistent behavior across platforms or keep the existing
        defaults per platform? Do the existing defaults continue to make sense
        given the presence of the kind attribute? Can we say something here
        without being overly prescriptive about platform-level default
        conventions?</p>
       
      
      
    
     </dl>
     
  
</ol>


   <h2 class="heading settled" data-level="8" id="media-session-interruption"><span class="secno">8. </span><span class="content">Media session interruption</span><a class="self-link" href="#media-session-interruption"></a></h2>


   <p>A <a data-link-type="dfn" href="#media-session">media session</a> may be interrupted at any time after its
<a data-link-type="dfn" href="#media-session-invocation-algorithm">media session invocation algorithm</a> has been run. This typically occurs
when another application or <a data-link-type="dfn" href="#media-session">media session</a> requests and is granted
platform-level media focus.</p>


   <p>Interruptions can be both transient or permanent. A transient interruption means
we can choose to either continue playing out our content at a reduced volume for
the duration of the interruption or we can pause our content for the duration of
the interruption and then, optionally, resume playback when the interruption
ends. A permanent interruption means we must pause our media content
indefinitely.</p>


   <p>When a <a data-link-type="dfn" href="#media-session">media session</a> receives an interruption notification from the
platform, run the
<a data-link-type="dfn" href="#media-session-interruption-algorithm">media session interruption algorithm</a> passing in the <a data-link-type="dfn" href="#media-session">media session</a>
as <var>current media session</var>.</p>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="media-session-interruption-algorithm">media session interruption algorithm<a class="self-link" href="#media-session-interruption-algorithm"></a></dfn> takes one argument,
<var>current media session</var>, and consists of running the following steps.</p>


   <ol>
  
    <li>
    Let <var>interrupting media category</var> be the <a data-link-type="dfn" href="#media-category">media category</a> that
    triggered this interruption. If this interruption has no known
    <a data-link-type="dfn" href="#media-category">media category</a>, let <var>interrupting media category</var> be
    <code><a data-link-type="dfn" href="#default-media-state">Default</a></code>.
  
  
    <li>
    Let <var>current media category</var> be the <var>current media
    session</var>â€™s associated <a data-link-type="dfn" href="#media-category">media category</a>. If <var>current media
    session</var> has no known
    <a data-link-type="dfn" href="#media-category">media category</a>, let <var>current media category</var> be <code><a data-link-type="dfn" href="#default-media-state">Default</a></code>.
  
  
    <li>
    If <var>current media session</var>â€™s <a data-link-type="dfn" href="#current-state">current state</a> is not <code><a data-link-type="dfn" href="#active-media-session-state">ACTIVE</a></code> abort any remaining steps
    and return.
  
  
    <li>
    Run these substeps:

    
     <dl class="switch">
      
      <dt>
        If <var>interrupting media category</var> is <code><a data-link-type="dfn" href="#content-media-state">Content</a></code>
      
      
      
      <dd>
        
       <ol>
          
        <li>
            If <var>current media category</var> is <code><a data-link-type="dfn" href="#default-media-state">Default</a></code> or <code><a data-link-type="dfn" href="#content-media-state">Content</a></code> then <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-pause">pause()</a></code> all of <var>current media
            session</var>â€™s
            <a data-link-type="dfn" href="#participating-media-elements">participating media elements</a> and set
            <var>current media session</var>â€™s <a data-link-type="dfn" href="#current-state">current state</a> to
            <code><a data-link-type="dfn" href="#idle-media-session-state">IDLE</a></code>.

            
         <p class="note" role="note">
              This implies that the next time the <a data-link-type="dfn" href="#media-session-invocation-algorithm">media session invocation
              algorithm</a>
              is run against a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> in <a data-link-type="dfn" href="#media-session">media session</a>
              that we will re-request media focus according to the steps defined
              in that algorithm.
            </p>
         
          
        
          
        <li>
            Optionally, based on platform conventions, the user agent must
            remove any previously established ongoing media interface in the
            underlying platformâ€™s notifications area and any ongoing media
            interface in the underlying platformâ€™s lock screen area for
            <var>current media session</var>, if any.
          
        
          
        <li>
            Optionally, based on platform conventions, the user agent must
            prevent any hardware and/or software media keys from controlling
            playback of
            <var>current media session</var>â€™s <a data-link-type="dfn" href="#active-media-session-state">active</a> <a data-link-type="dfn" href="#participating-media-elements">participating media elements</a>.
          
        
        
       </ol>
       
      
      
      
      <dt>
        If <var>interrupting media category</var> is <code><a data-link-type="dfn" href="#transient-mixable-media-state">Transient_Mixable</a></code>
      
      
      
      <dd>
        
       <ol>
          
        <li>
            If <var>current media category</var> is <code><a data-link-type="dfn" href="#default-media-state">Default</a></code> or <code><a data-link-type="dfn" href="#content-media-state">Content</a></code> then duck (i.e. reduce the output volume)
            all of <var>current media session</var>â€™s <a data-link-type="dfn" href="#active-media-session-state">active</a> <a data-link-type="dfn" href="#participating-media-elements">participating media elements</a> and
            set
            <var>current media session</var>â€™s
            <a data-link-type="dfn" href="#current-state">current state</a> to <code><a data-link-type="dfn" href="#interrupted-media-session-state">INTERRUPTED</a></code>.
            
         <p class="note" role="note">
              This implies that the next time the <a data-link-type="dfn" href="#media-session-release-algorithm">media session release
              algorithm</a>
              is run that we will re-activate this <a data-link-type="dfn" href="#media-session">media session</a>
              according to the steps defined in that algorithm.
            </p>
         
          
        
        
       </ol>
       
      
      
      
      <dt>
        If <var>interrupting media category</var> is <code><a data-link-type="dfn" href="#transient-exclusive-media-state">Transient_Exclusive</a></code>
      
      
      
      <dd>
        
       <ol>
          
        <li>
            If <var>current media category</var> is <code><a data-link-type="dfn" href="#default-media-state">Default</a></code>, <code><a data-link-type="dfn" href="#content-media-state">Content</a></code>, <code><a data-link-type="dfn" href="#transient-mixable-media-state">Transient_Mixable</a></code> or <code><a data-link-type="dfn" href="#transient-exclusive-media-state">Transient_Exclusive</a></code> then
            <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-pause">pause()</a></code> all of <var>current media session</var>â€™s
            <a data-link-type="dfn" href="#participating-media-elements">participating media elements</a> and set <var>current media
            session</var>â€™s <a data-link-type="dfn" href="#current-state">current state</a> to
            <code><a data-link-type="dfn" href="#interrupted-media-session-state">INTERRUPTED</a></code>.

            
         <div class="note" role="note">
              
          <p>
                This implies that the next time the <a data-link-type="dfn" href="#media-session-invocation-algorithm">media session invocation
                algorithm</a>
                is run against a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> in <a data-link-type="dfn" href="#media-session">media session</a>
                that we will re-request media focus according to the steps
                defined in that algorithm.
              </p>
          

              
          <p>
                It also implies that the next time the <a data-link-type="dfn" href="#media-session-release-algorithm">media session release
                algorithm</a>
                is run that we will re-activate this <a data-link-type="dfn" href="#media-session">media session</a>
                according to the steps defined in that algorithm.
              </p>
          
            
         </div>
         
          
        
        
       </ol>
       
      
      
    
     </dl>
     
  
</ol>


   <h2 class="heading settled" data-level="9" id="media-session-release"><span class="secno">9. </span><span class="content">Media session release</span><a class="self-link" href="#media-session-release"></a></h2>


   <p>When a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a>â€™s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#ended-playback">playback has ended</a>, run
the <a data-link-type="dfn" href="#media-session-release-algorithm">media session release algorithm</a> passing in the
<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> as <var>current media element</var>.</p>


   <p>Additionally, any time a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a>â€™s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element-load-algorithm">load algorithm</a> is run, also run the <a data-link-type="dfn" href="#media-session-release-algorithm">media session release
algorithm</a> passing in the
<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> as <var>current media element</var>.</p>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="media-session-release-algorithm">media session release algorithm<a class="self-link" href="#media-session-release-algorithm"></a></dfn> takes one argument,
<var>current media element</var>, and consists of running the following steps.</p>


   <ol>
  
    <li>
    Set <var>current media session</var> to <var>current media element</var>â€™s
    <a data-link-type="dfn" href="#current-media-session">current media session</a>, if any.
  
  
    <li>
    If <var>current media session</var> is empty then abort any remaining steps.
  
  
    <li>
    Optionally, based on platform conventions, the user agent must release any
    currently held platform media focus for <var>current media session</var>.
  

  
    <li>
    Optionally, based on platform conventions, the user agent must remove any
    previously established ongoing media interface in the underlying platformâ€™s
    notifications area and any ongoing media interface in the underlying
    platformâ€™s lock screen area for
    <var>current media session</var>, if any.
  
  
    <li>
    Optionally, based on platform conventions, the user agent must prevent any
    hardware and/or software media keys from controlling playback of
    <var>current media session</var>â€™s
    <a data-link-type="dfn" href="#participating-media-elements">participating media elements</a>.
  
  
    <li>
    Set <var>current media session</var>â€™s <a data-link-type="dfn" href="#current-state">current state</a> to
    <code><a data-link-type="dfn" href="#idle-media-session-state">IDLE</a></code>.

    
     <p class="note" role="note">
      This implies that the next time the <a data-link-type="dfn" href="#media-session-invocation-algorithm">media session invocation
      algorithm</a>
      is run against a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> in <a data-link-type="dfn" href="#current-media-session">current media session</a>
      that we will re-request media focus according to the steps defined in that
      algorithm.
    </p>
     
  
  
    <li>
    Let <var>releasing media category</var> be the <var>current media
    session</var>â€™s associated <a data-link-type="dfn" href="#media-category">media category</a>. If <var>current media
    session</var> has no known
    <a data-link-type="dfn" href="#media-category">media category</a>, let <var>releasing media category</var> be <code><a data-link-type="dfn" href="#default-media-state">Default</a></code>.
  
  
    <li>
    For every other <a data-link-type="dfn" href="#media-session">media session</a> known to the user agent, run the
    following substeps, passing in each <a data-link-type="dfn" href="#media-session">media session</a> as <var>incumbent
    media session</var>:

    
     <ol>
      
      <li>
        If <var>incumbent media session</var>â€™s <a data-link-type="dfn" href="#current-state">current state</a> is not
        <code><a data-link-type="dfn" href="#interrupted-media-session-state">INTERRUPTED</a></code>
        then abort any remaining substeps and continue at the next available
        <var>incumbent media session</var>.
      
      
      
      <li>
        Run these substeps:

        
       <dl class="switch">
          
        <dt>
            If <var>releasing media category</var> is <code><a data-link-type="dfn" href="#transient-mixable-media-state">Transient_Mixable</a></code>
          
        
          
        <dd>
            
         <ol>
              
          <li>
                If <var>incumbent media session</var>â€™s associated <a data-link-type="dfn" href="#media-category">media
                category</a> is <code><a data-link-type="dfn" href="#default-media-state">Default</a></code> or
                <code><a data-link-type="dfn" href="#content-media-state">Content</a></code>
                then unduck (i.e. restore the volume) of <var>incumbent media
                session</var>â€™s
                <a data-link-type="dfn" href="#participating-media-elements">participating media elements</a>
                and set <var>incumbent media session</var>â€™s <a data-link-type="dfn" href="#current-state">current
                state</a> to <code><a data-link-type="dfn" href="#active-media-session-state">ACTIVE</a></code>.
              
          
            
         </ol>
         
          
        
          
        <dt>
            If <var>releasing media category</var> is <code><a data-link-type="dfn" href="#transient-exclusive-media-state">Transient_Exclusive</a></code>
          
        
          
        <dd>
            
         <ol>
              
          <li>
                If <var>incumbent media session</var>â€™s associated <a data-link-type="dfn" href="#media-category">media
                category</a> is <code><a data-link-type="dfn" href="#default-media-state">Default</a></code>,
                <code><a data-link-type="dfn" href="#content-media-state">Content</a></code>, <code><a data-link-type="dfn" href="#transient-mixable-media-state">Transient_Mixable</a></code>,
                or <code><a data-link-type="dfn" href="#transient-exclusive-media-state">Transient_Exclusive</a></code> then un-<code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-pause">pause()</a></code> the
                <var>incumbent media session</var>â€™s <a data-link-type="dfn" href="#active-media-session-state">active</a>
                <a data-link-type="dfn" href="#participating-media-elements">participating media elements</a>
                and set <var>incumbent media session</var>â€™s <a data-link-type="dfn" href="#current-state">current
                state</a> to <code><a data-link-type="dfn" href="#active-media-session-state">ACTIVE</a></code>.
              
          
            
         </ol>
         
          
        
        
       </dl>
       
      
      
    
     </ol>
     
  
</ol>

</main>
  


  <h2 class="no-num heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="indexlist">
   <li>active media session state, <a href="#active-media-session-state">5</a>
   <li>ambient attribute value, <a href="#ambient-attribute-value">4</a>
   <li>ambient media state, <a href="#ambient-media-state">4</a>
   <li>audio kind, <a href="#audio-kind">6.3</a>
   <li>content attribute value, <a href="#content-attribute-value">4</a>
   <li>content media state, <a href="#content-media-state">4</a>
   <li>current media session, <a href="#current-media-session">5</a>
   <li>current state, <a href="#current-state">5</a>
   <li>default media state, <a href="#default-media-state">4</a>
   <li>idle media session state, <a href="#idle-media-session-state">5</a>
   <li>interrupted media session state, <a href="#interrupted-media-session-state">5</a>
   <li>kind, <a href="#dom-htmlmediaelement-kind">6.1</a>
   <li>media category, <a href="#media-category">4</a>
   <li>media session, <a href="#media-session">5</a>
   <li>media session interruption algorithm, <a href="#media-session-interruption-algorithm">8</a>
   <li>media session invocation algorithm, <a href="#media-session-invocation-algorithm">7</a>
   <li>media session release algorithm, <a href="#media-session-release-algorithm">9</a>
   <li>participating media elements, <a href="#participating-media-elements">5</a>
   <li>transient attribute
      value, <a href="#transient-attribute-value">4</a>
   <li>transient exclusive media state, <a href="#transient-exclusive-media-state">4</a>
   <li>transient mixable media state, <a href="#transient-mixable-media-state">4</a>
   <li>transientsolo attribute
      value, <a href="#transientsolo-attribute-value">4</a>
   <li>video kind, <a href="#video-kind">6.2</a></ul>
  <h3 class="no-num heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="indexlist">
   <li><a data-link-type="biblio" href="#biblio-html">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-have_enough_data">HAVE_ENOUGH_DATA</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-have_future_data">HAVE_FUTURE_DATA</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#htmlmediaelement">HTMLMediaElement</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#audio">audio</a>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context">browsing context</a>
     <li><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#case-sensitivity-and-string-comparison">case-sensitive</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#ended-playback">ended playback</a>
     <li><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#enumerated-attribute">enumerated attribute</a>
     <li><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#limited-to-only-known-values">limited to only known values</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element-load-algorithm">media element load algorithm</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#event-media-pause">pause</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-pause">pause()</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-paused">paused</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#event-media-play">play</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-play">play()</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#potentially-playing">potentially playing</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-readystate">readyState</a>
     <li><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#reflect">reflect</a>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">top-level browsing context</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#video">video</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-webaudio">[webaudio]</a> defines the following terms:
    <ul>
     <li><a href="http://webaudio.github.io/web-audio-api/#audiocontext">AudioContext</a>
    </ul></ul>
  <h2 class="no-num heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-html"><a class="self-link" href="#biblio-html"></a>[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-webidl"><a class="self-link" href="#biblio-webidl"></a>[WebIDL]
   <dd>Cameron McCormack. <a href="https://heycam.github.io/webidl/">Web IDL</a>. 19 April 2012. CR. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
   <dt id="biblio-rfc2119"><a class="self-link" href="#biblio-rfc2119"></a>[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-webaudio"><a class="self-link" href="#biblio-webaudio"></a>[WEBAUDIO]
   <dd>Paul Adenot; Chris Wilson; Chris Rogers. <a href="https://webaudio.github.io/web-audio-api/">Web Audio API</a>. 10 October 2013. WD. URL: <a href="https://webaudio.github.io/web-audio-api/">https://webaudio.github.io/web-audio-api/</a></dl>
  <script>self = (typeof window !== 'undefined')
	? window   // if in browser
	: (
		(typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)
		? self // if in worker
		: {}   // if in node js
	);

/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 * MIT license http://www.opensource.org/licenses/mit-license.php/
 * @author Lea Verou http://lea.verou.me
 */

var Prism = (function(){

// Private helper vars
var lang = /\blang(?:uage)?-(?!\*)(\w+)\b/i;

var _ = self.Prism = {
	util: {
		encode: function (tokens) {
			if (tokens instanceof Token) {
				return new Token(tokens.type, _.util.encode(tokens.content), tokens.alias);
			} else if (_.util.type(tokens) === 'Array') {
				return tokens.map(_.util.encode);
			} else {
				return tokens.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/\u00a0/g, ' ');
			}
		},

		type: function (o) {
			return Object.prototype.toString.call(o).match(/\[object (\w+)\]/)[1];
		},

		// Deep clone a language definition (e.g. to extend it)
		clone: function (o) {
			var type = _.util.type(o);

			switch (type) {
				case 'Object':
					var clone = {};

					for (var key in o) {
						if (o.hasOwnProperty(key)) {
							clone[key] = _.util.clone(o[key]);
						}
					}

					return clone;

				case 'Array':
					return o.slice();
			}

			return o;
		}
	},

	languages: {
		extend: function (id, redef) {
			var lang = _.util.clone(_.languages[id]);

			for (var key in redef) {
				lang[key] = redef[key];
			}

			return lang;
		},

		// Insert a token before another token in a language literal
		insertBefore: function (inside, before, insert, root) {
			root = root || _.languages;
			var grammar = root[inside];
			var ret = {};

			for (var token in grammar) {

				if (grammar.hasOwnProperty(token)) {

					if (token == before) {

						for (var newToken in insert) {

							if (insert.hasOwnProperty(newToken)) {
								ret[newToken] = insert[newToken];
							}
						}
					}

					ret[token] = grammar[token];
				}
			}

			return root[inside] = ret;
		},

		// Traverse a language definition with Depth First Search
		DFS: function(o, callback, type) {
			for (var i in o) {
				if (o.hasOwnProperty(i)) {
					callback.call(o, i, o[i], type || i);

					if (_.util.type(o[i]) === 'Object') {
						_.languages.DFS(o[i], callback);
					} else if (_.util.type(o[i]) === 'Array') {
						_.languages.DFS(o[i], callback, i);
					}
				}
			}
		}
	},

	highlightAll: function(async, callback) {
		var elements = document.querySelectorAll('code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code');
		for (var i=0, element; element = elements[i++];) {
			if (element.classList.contains("idl")) {
				// Bikeshed handles IDL blocks already.
				continue;
			}
			_.highlightElement(element, async === true, callback);
		}

		var elements = document.querySelectorAll('pre[class*="language-"], [class*="language-"] pre, pre[class*="lang-"], [class*="lang-"] pre');
		for (var i=0, element; element = elements[i++];) {
			if (element.firstElementChild && element.firstElementChild.tagName.toLowerCase() == "code") {
				// Already handled by the previous loop
				continue;
			}
			if (element.classList.contains("idl")) {
				// Bikeshed handles IDL blocks already.
				continue;
			}
			_.highlightElement(element, async === true, callback);
		}
	},

	highlightElement: function(element, async, callback) {
		// Find language
		var language, grammar, parent = element;

		while (parent && !lang.test(parent.className)) {
			parent = parent.parentNode;
		}

		if (parent) {
			language = (parent.className.match(lang) || [,''])[1];
			grammar = _.languages[language];
		}

		if (!grammar) {
			return;
		}

		// Set language on the element, if not present
		element.className = element.className.replace(lang, '').replace(/\s+/g, ' ') + ' language-' + language;

		// Set language on the parent, for styling
		parent = element.parentNode;

		if (/pre/i.test(parent.nodeName)) {
			parent.className = parent.className.replace(lang, '').replace(/\s+/g, ' ') + ' language-' + language;
		}

		var code = element.textContent;

		if(!code) {
			return;
		}

		var env = {
			element: element,
			language: language,
			grammar: grammar,
			code: code
		};

		_.hooks.run('before-highlight', env);

		if (async && self.Worker) {
			var worker = new Worker(_.filename);

			worker.onmessage = function(evt) {
				env.highlightedCode = Token.stringify(JSON.parse(evt.data), language);

				_.hooks.run('before-insert', env);

				env.element.innerHTML = env.highlightedCode;

				callback && callback.call(env.element);
				_.hooks.run('after-highlight', env);
			};

			worker.postMessage(JSON.stringify({
				language: env.language,
				code: env.code
			}));
		}
		else {
			env.highlightedCode = _.highlight(env.code, env.grammar, env.language)

			_.hooks.run('before-insert', env);

			env.element.innerHTML = env.highlightedCode;

			callback && callback.call(element);

			_.hooks.run('after-highlight', env);
		}
	},

	highlight: function (text, grammar, language) {
		var tokens = _.tokenize(text, grammar);
		return Token.stringify(_.util.encode(tokens), language);
	},

	tokenize: function(text, grammar, language) {
		var Token = _.Token;

		var strarr = [text];

		var rest = grammar.rest;

		if (rest) {
			for (var token in rest) {
				grammar[token] = rest[token];
			}

			delete grammar.rest;
		}

		tokenloop: for (var token in grammar) {
			if(!grammar.hasOwnProperty(token) || !grammar[token]) {
				continue;
			}

			var patterns = grammar[token];
			patterns = (_.util.type(patterns) === "Array") ? patterns : [patterns];

			for (var j = 0; j < patterns.length; ++j) {
				var pattern = patterns[j],
					inside = pattern.inside,
					lookbehind = !!pattern.lookbehind,
					lookbehindLength = 0,
					alias = pattern.alias;

				pattern = pattern.pattern || pattern;

				for (var i=0; i<strarr.length; i++) { // Donâ€™t cache length as it changes during the loop

					var str = strarr[i];

					if (strarr.length > text.length) {
						// Something went terribly wrong, ABORT, ABORT!
						break tokenloop;
					}

					if (str instanceof Token) {
						continue;
					}

					pattern.lastIndex = 0;

					var match = pattern.exec(str);

					if (match) {
						if(lookbehind) {
							lookbehindLength = match[1].length;
						}

						var from = match.index - 1 + lookbehindLength,
							match = match[0].slice(lookbehindLength),
							len = match.length,
							to = from + len,
							before = str.slice(0, from + 1),
							after = str.slice(to + 1);

						var args = [i, 1];

						if (before) {
							args.push(before);
						}

						var wrapped = new Token(token, inside? _.tokenize(match, inside) : match, alias);

						args.push(wrapped);

						if (after) {
							args.push(after);
						}

						Array.prototype.splice.apply(strarr, args);
					}
				}
			}
		}

		return strarr;
	},

	hooks: {
		all: {},

		add: function (name, callback) {
			var hooks = _.hooks.all;

			hooks[name] = hooks[name] || [];

			hooks[name].push(callback);
		},

		run: function (name, env) {
			var callbacks = _.hooks.all[name];

			if (!callbacks || !callbacks.length) {
				return;
			}

			for (var i=0, callback; callback = callbacks[i++];) {
				callback(env);
			}
		}
	}
};

var Token = _.Token = function(type, content, alias) {
	this.type = type;
	this.content = content;
	this.alias = alias;
};

Token.stringify = function(o, language, parent) {
	if (typeof o == 'string') {
		return o;
	}

	if (Object.prototype.toString.call(o) == '[object Array]') {
		return o.map(function(element) {
			return Token.stringify(element, language, o);
		}).join('');
	}

	var env = {
		type: o.type,
		content: Token.stringify(o.content, language, parent),
		tag: 'span',
		classes: ['token', o.type],
		attributes: {},
		language: language,
		parent: parent
	};

	if (env.type == 'comment') {
		env.attributes['spellcheck'] = 'true';
	}

	if (o.alias) {
		var aliases = _.util.type(o.alias) === 'Array' ? o.alias : [o.alias];
		Array.prototype.push.apply(env.classes, aliases);
	}

	_.hooks.run('wrap', env);

	var attributes = '';

	for (var name in env.attributes) {
		attributes += name + '="' + (env.attributes[name] || '') + '"';
	}

	return '<' + env.tag + ' class="' + env.classes.join(' ') + '" ' + attributes + '>' + env.content + '</' + env.tag + '>';

};

if (!self.document) {
	if (!self.addEventListener) {
		// in Node.js
		return self.Prism;
	}
 	// In worker
	self.addEventListener('message', function(evt) {
		var message = JSON.parse(evt.data),
		    lang = message.language,
		    code = message.code;

		self.postMessage(JSON.stringify(_.util.encode(_.tokenize(code, _.languages[lang]))));
		self.close();
	}, false);

	return self.Prism;
}

// Get current script and highlight
var script = document.getElementsByTagName('script');

script = script[script.length - 1];

if (script) {
	_.filename = script.src;

	if (document.addEventListener && !script.hasAttribute('data-manual')) {
		document.addEventListener('DOMContentLoaded', _.highlightAll);
	}
}

return self.Prism;

})();

if (typeof module !== 'undefined' && module.exports) {
	module.exports = Prism;
}
;
Prism.languages.clike = {
	'comment': [
		{
			pattern: /(^|[^\\])\/\*[\w\W]*?\*\//g,
			lookbehind: true
		},
		{
			pattern: /(^|[^\\:])\/\/.*?(\r?\n|$)/g,
			lookbehind: true
		}
	],
	'string': /("|')(\\?.)*?\1/g,
	'class-name': {
		pattern: /((?:(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/ig,
		lookbehind: true,
		inside: {
			punctuation: /(\.|\\)/
		}
	},
	'keyword': /\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/g,
	'boolean': /\b(true|false)\b/g,
	'function': {
		pattern: /[a-z0-9_]+\(/ig,
		inside: {
			punctuation: /\(/
		}
	},
	'number': /\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?)\b/g,
	'operator': /[-+]{1,2}|!|<=?|>=?|={1,3}|&{1,2}|\|?\||\?|\*|\/|\~|\^|\%/g,
	'ignore': /&(lt|gt|amp);/gi,
	'punctuation': /[{}[\];(),.:]/g
};
;
Prism.languages.markup = {
	'comment': /<!--[\w\W]*?-->/g,
	'prolog': /<\?.+?\?>/,
	'doctype': /<!DOCTYPE.+?>/,
	'cdata': /<!\[CDATA\[[\w\W]*?]]>/i,
	'tag': {
		pattern: /<\/?[\w:-]+\s*(?:\s+[\w:-]+(?:=(?:("|')(\\?[\w\W])*?\1|[^\s'">=]+))?\s*)*\/?>/gi,
		inside: {
			'tag': {
				pattern: /^<\/?[\w:-]+/i,
				inside: {
					'punctuation': /^<\/?/,
					'namespace': /^[\w-]+?:/
				}
			},
			'attr-value': {
				pattern: /=(?:('|")[\w\W]*?(\1)|[^\s>]+)/gi,
				inside: {
					'punctuation': /=|>|"/g
				}
			},
			'punctuation': /\/?>/g,
			'attr-name': {
				pattern: /[\w:-]+/g,
				inside: {
					'namespace': /^[\w-]+?:/
				}
			}

		}
	},
	'entity': /\&#?[\da-z]{1,8};/gi
};

// Plugin to make entity title show the real entity, idea by Roman Komarov
Prism.hooks.add('wrap', function(env) {

	if (env.type === 'entity') {
		env.attributes['title'] = env.content.replace(/&amp;/, '&');
	}
});
;
Prism.languages.javascript = Prism.languages.extend('clike', {
	'keyword': /\b(break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|false|finally|for|function|get|if|implements|import|in|instanceof|interface|let|new|null|package|private|protected|public|return|set|static|super|switch|this|throw|true|try|typeof|var|void|while|with|yield)\b/g,
	'number': /\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?|NaN|-?Infinity)\b/g
});

Prism.languages.insertBefore('javascript', 'keyword', {
	'regex': {
		pattern: /(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/g,
		lookbehind: true
	}
});

if (Prism.languages.markup) {
	Prism.languages.insertBefore('markup', 'tag', {
		'script': {
			pattern: /<script[\w\W]*?>[\w\W]*?<\/script>/ig,
			inside: {
				'tag': {
					pattern: /<script[\w\W]*?>|<\/script>/ig,
					inside: Prism.languages.markup.tag.inside
				},
				rest: Prism.languages.javascript
			}
		}
	});
}
;
</script>
 </body>
</html>