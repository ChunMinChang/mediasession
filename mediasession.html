<!doctype html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  
  
  <title>Media Session Standard</title>
  
  
  <link href="https://www.whatwg.org/style/specification" rel="stylesheet">
  
  
  <link href="https://resources.whatwg.org/bikeshed.css" rel="stylesheet">
  
  
  <link href="https://resources.whatwg.org/logo.svg" rel="icon">
  

  <meta content="Bikeshed 1.0.0" name="generator">
  <style>/* http://prismjs.com/download.html?themes=prism&languages=clike */
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', monospace;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #a67f59;
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important {
	font-weight: bold;
}

.token.entity {
	cursor: help;
}
</style>
 </head>
 <body class="h-entry status-LS">

  <div class="head">
  
   <p data-fill-with="logo"><a class="logo" href="https://whatwg.org/">
    <img alt="WHATWG" height="100" src="https://resources.whatwg.org/logo.svg">
</a>
</p>
  
   <h1 class="p-name no-ref" id="title">Media Session</h1>
  
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Living Standard â€” Last Updated
    <time class="dt-updated" datetime="2015-05-06">6 May 2015</time></span></h2>
  
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>Participate:
     <dd><span><a href="https://github.com/whatwg/mediasession/issues/new">File an issue</a> (<a href="https://github.com/whatwg/mediasession/issues?state=open">open issues</a>)</span>
     <dd><span><a href="https://wiki.whatwg.org/wiki/IRC">IRC: #whatwg on Freenode</a></span>
     <dt>Version History:
     <dd><span><a href="https://github.com/whatwg/mediasession/commits">https://github.com/whatwg/mediasession/commits</a></span>
    </dl>
   </div>
  
   <div data-fill-with="warning"></div>
</div>
  


  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  

  <div class="p-summary" data-fill-with="abstract">
   <p>This specification adds the primitives required to obtain different

levels of platform media focus and access to platform media keys such
as hardware keys found on keyboards, headsets, remote controls, and
software keys found in notification areas and on lock screens of
mobile devices.</p>

</div>
  

  <div data-fill-with="at-risk"></div>
  


  <h2 class="no-num no-toc no-ref heading settled" id="contents"><span class="content">Table of Contents</span></h2>
  

  <div data-fill-with="table-of-contents" role="navigation">
   <ul class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li><a href="#conformance"><span class="secno">2</span> <span class="content">Conformance</span></a>
    <li><a href="#dependencies"><span class="secno">3</span> <span class="content">Dependencies</span></a>
    <li><a href="#example"><span class="secno">4</span> <span class="content">Example Usage</span></a>
    <li><a href="#categories"><span class="secno">5</span> <span class="content">Media Categories</span></a>
    <li><a href="#sessions"><span class="secno">6</span> <span class="content">Media Sessions</span></a>
    <li><a href="#setting-media-category"><span class="secno">7</span> <span class="content">Assigning a Media Category to Media
Elements</span></a>
     <ul class="toc">
      <li><a href="#html-media-element-additions"><span class="secno">7.1</span> <span class="content">Additions to <code class="idl"><span>HTMLMediaElement</span></code></span></a>
      <li><a href="#video-element-additions"><span class="secno">7.2</span> <span class="content">Additions to the <code><span>video</span></code> element</span></a>
      <li><a href="#audio-element-additions"><span class="secno">7.3</span> <span class="content">Additions to the <code><span>audio</span></code> element</span></a>
     </ul>
    <li><a href="#invoking-media-session"><span class="secno">8</span> <span class="content">Media Session Invocation</span></a>
    <li><a href="#interrupting-media-session"><span class="secno">9</span> <span class="content">Media Session Interruption</span></a>
    <li><a href="#terminating-media-session"><span class="secno">10</span> <span class="content">Media Session Termination</span></a>
    <li><a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ul class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
     </ul>
    <li><a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ul class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ul>
   </ul></div>
  

  <main>





   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>


   <p><em>This section is non-normative.</em></p>


   <p>Media is used extensively today on the web to play a variety of different types
of media content. It is often used to play music, podcasts and radio content. At
other times media elements are used to provide background music, sound effects,
notification sounds and to render WebRTC media stream content.</p>


   <p>When playing media on the web, developers are currently forced to adopt a single
default platform modality for playing web media content. On the other hand,
native applications can access much richer media integration options with an
underlying platform. On mobile devices, native application developers can
request many different forms of media integration with the underlying platform
to obtain access to headphone buttons, lock screens and notification areas as
needed. On desktop devices, native applications have access to keyboard media
key events. Native application developers can specify the conditions in which
media content should pause or duck on audio interruptions (i.e. pause or lower
the volume for the duration of the interruption), continue playing out when
application focus is lost or the device screen is switched off and interface
with internal and external remote controllers.</p>


   <p>This specification provides these powerful media integration features for web
media. By allowing web developers to express the intended usage of their media,
user agents can supply the most suitable platform-level interactions for that
media and enforce logical inter-operation behavior on the current platform
between any number of different sources of media.</p>


   <p>The specification details the mechanism that allows web developers to specify
the most appropriate category for their media and for user agents to then use
these supplied hints to enforce how different sources of web media should
interact with each other, other native media content and the underlying
platform.</p>


   <h2 class="heading settled" data-level="2" id="conformance"><span class="secno">2. </span><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>


   <p>All diagrams, examples, and notes in this specification are non-normative, as
are all sections explicitly marked non-normative. Everything else in this
specification is normative.</p>


   <p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in RFC 2119. For readability, these
words do not appear in all uppercase letters in this specification. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>


   <p>Requirements phrased in the imperative as part of algorithms (such as "strip any
leading space characters" or "return false and terminate these steps") are to be
interpreted with the meaning of the key word ("must", "should", "may", etc) used
in introducing the algorithm.</p>


   <p>Conformance requirements phrased as algorithms or specific steps may be
implemented in any manner, so long as the end result is equivalent. (In
particular, the algorithms defined in this specification are intended to be easy
to follow, and not intended to be performant.)</p>


   <p>User agents may impose implementation-specific limits on otherwise unconstrained
inputs, e.g. to prevent denial of service attacks, to guard against running out
of memory, or to work around platform-specific limitations.</p>


   <p>When a method or an attribute is said to call another method or attribute, the
user agent must invoke its internal API for that attribute or method so that
e.g. the author canâ€™t change the behavior by overriding attributes or methods
with custom properties or functions in JavaScript.</p>


   <p>Unless otherwise stated, string comparisons are done in a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#case-sensitivity-and-string-comparison">case-sensitive</a>
manner.</p>


   <h2 class="heading settled" data-level="3" id="dependencies"><span class="secno">3. </span><span class="content">Dependencies</span><a class="self-link" href="#dependencies"></a></h2>


   <p>The IDL fragments in this specification must be interpreted as required for
conforming IDL fragments, as described in the Web IDL specification. <a data-link-type="biblio" href="#biblio-webidl">[WEBIDL]</a></p>


   <h2 class="heading settled" data-level="4" id="example"><span class="secno">4. </span><span class="content">Example Usage</span><a class="self-link" href="#example"></a></h2>


   <p>A <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#video">video</a></code> elementâ€™s <code><a data-link-type="dfn" href="#audio-kind">kind</a></code> content attribute can be declared in HTML:</p>


   <pre class="lang-markup">&lt;video src="short_ping.webm" kind="transient">
</pre>


   <p>Similarly, an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#audio">audio</a></code> elementâ€™s <code><a data-link-type="dfn" href="#audio-kind">kind</a></code> content attribute can be declared in HTML:</p>


   <pre class="lang-markup">&lt;audio src="track1.ogg" kind="content">
</pre>


   <p>As both <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#audio">audio</a></code> and <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#video">video</a></code>
elements implement the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#htmlmediaelement">HTMLMediaElement</a></code> interface, these elementâ€™s
<code class="idl"><a data-link-type="idl" href="#dom-htmlmediaelement-kind">kind</a></code> IDL attribute can also be set via JavaScript:</p>


   <pre class="lang-javascript">var myAudio = document.createElement('audio');
console.log(myAudio.kind) // --> ""
myAudio.src = "music.mp3";
myAudio.kind = "content";
// myAudio.outerHTML === "&lt;audio src="music.mp3" kind="content">&lt;/audio>" === true
</pre>


   <h2 class="heading settled" data-level="5" id="categories"><span class="secno">5. </span><span class="content">Media Categories</span><a class="self-link" href="#categories"></a></h2>


   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="media-category">media category<a class="self-link" href="#media-category"></a></dfn> is a keyword that maps to a well-defined interaction
state for a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> that user agents use to enforce
platform-specific interaction and interoperation between web media.</p>


   <p>The following table lists the available <a data-link-type="dfn" href="#media-category">media
categories</a> keywords and states â€” the keywords in the left column map to
the states in the cell in the second column on the same row as the keyword. The
attribute should be set based on the preferred definitions in the tableâ€™s
third and fourth columns.</p>


   <table id="valid-media-categories">
  
    <tbody>
     <tr>
    
      <th>Category
      
    
      <th>State
      
    
      <th>Definition
      
    
      <th>Examples
      
  
     
  
     <tr>
    
      <td>
      "<dfn data-dfn-type="dfn" data-lt="content attribute value" data-noexport="" id="content-attribute-value"><code>content</code><a class="self-link" href="#content-attribute-value"></a></dfn>"
    
      
    
      <td>
      <dfn data-dfn-type="dfn" data-lt="content media state" data-noexport="" id="content-media-state">Content<a class="self-link" href="#content-media-state"></a></dfn>
    
      
    
      <td>
      Pauses all other media content. Displays lock-screen and notification area
      user interfaces and reacts to changes in both hardware and software-based
      media key buttons.
    
      
    
      <td>
      Music, podcasts, radio
    
      
  
     
  
     <tr>
    
      <td>
      "<dfn data-dfn-type="dfn" data-lt="transient attribute
      value" data-noexport="" id="transient-attribute-value"><code>transient</code><a class="self-link" href="#transient-attribute-value"></a></dfn>"
    
      
    
      <td>
      <dfn data-dfn-type="dfn" data-lt="transient media state" data-noexport="" id="transient-media-state">Transient<a class="self-link" href="#transient-media-state"></a></dfn>
    
      
    
      <td>
      Does not pause other media content. Ducks other content currently playing
      out. Does not display lock-screen or notification area user interfaces and
      does not react to changes in both hardware and software-based media key
      buttons.
    
      
    
      <td>
      Notification sounds. Spoken driving directions.
    
      
  
     
  
     <tr>
    
      <td>
      "<strong id="default-media-value"><code></code></strong>" (empty
      string)
    
      
    
      <td>
      <dfn data-dfn-type="dfn" data-lt="default media state" data-noexport="" id="default-media-state">Default<a class="self-link" href="#default-media-state"></a></dfn>
    
      
    
      <td>
      No explicit kind, or the kind of the media given is not recognized by the
      user agent.
    
      
    
      <td>
      Legacy media content
    
      
  
     
</table>


   <h2 class="heading settled" data-level="6" id="sessions"><span class="secno">6. </span><span class="content">Media Sessions</span><a class="self-link" href="#sessions"></a></h2>


   <p>A <dfn data-dfn-type="dfn" data-noexport="" id="media-session">media session<a class="self-link" href="#media-session"></a></dfn> represents one or more <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media
elements</a> within the same <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">top-level browsing context</a> that share the
same <a data-link-type="dfn" href="#media-category">media category</a>. Each <a data-link-type="dfn" href="#media-session">media session</a> then defines the
interactions of those <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media elements</a> with both the
underlying platform and other <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media elements</a> belonging
to other <a data-link-type="dfn" href="#media-session">media sessions</a> within the user agent.</p>


   <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> can have a <dfn data-dfn-type="dfn" data-noexport="" id="current-media-session">current media session<a class="self-link" href="#current-media-session"></a></dfn>, which is a
<a data-link-type="dfn" href="#media-session">media session</a> object. When a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> is created it does not
have a <a data-link-type="dfn" href="#current-media-session">current media session</a>.</p>


   <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> obtains a <a data-link-type="dfn" href="#current-media-session">current media session</a> object only when
it first reaches a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#potentially-playing">potentially playing</a> state per the <a data-link-type="dfn" href="#media-session-invocation-algorithm">media session
invocation algorithm</a> below. A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a>â€™s <a data-link-type="dfn" href="#current-media-session">current media
session</a> is removed when it subsequently reaches a non-<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#potentially-playing">potentially
playing</a> state per the <a data-link-type="dfn" href="#media-session-termination-algorithm">media session termination algorithm</a> below.</p>


   <p>The <dfn data-dfn-type="dfn" data-noexport="" id="session-media-elements">session media elements<a class="self-link" href="#session-media-elements"></a></dfn> of a <a data-link-type="dfn" href="#media-session">media session</a> object are the
<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media elements</a> whose <a data-link-type="dfn" href="#current-media-session">current media session</a> is that
<a data-link-type="dfn" href="#media-session">media session</a> object.</p>


   <h2 class="heading settled" data-level="7" id="setting-media-category"><span class="secno">7. </span><span class="content">Assigning a Media Category to Media
Elements</span><a class="self-link" href="#setting-media-category"></a></h2>


   <h3 class="heading settled" data-level="7.1" id="html-media-element-additions"><span class="secno">7.1. </span><span class="content">Additions to <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#htmlmediaelement">HTMLMediaElement</a></code></span><a class="self-link" href="#html-media-element-additions"></a></h3>


   <pre class="idl">partial interface <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/embedded-content.html#htmlmediaelement">HTMLMediaElement</a> {
  attribute DOMString <a class="idl-code" data-global-name="HTMLMediaElement<interface>/kind<attribute>" data-link-type="attribute" data-type="DOMString " href="#dom-htmlmediaelement-kind">kind</a>;
};
</pre>


   <dl class="domintro">
  
    <dt>
    <code><var>media</var> . <code class="idl"><a data-link-type="idl" href="#dom-htmlmediaelement-kind">kind</a></code></code>
  
  
    <dd>
    Returns the category the given media falls into. The <a href="#valid-media-categories">possible media categories</a> are defined
    above.
  
</dl>


   <p>The <dfn class="idl-code" data-dfn-for="HTMLMediaElement" data-dfn-type="attribute" data-export="" id="dom-htmlmediaelement-kind"><code>kind</code><a class="self-link" href="#dom-htmlmediaelement-kind"></a></dfn> IDL
attribute is intended to provide a hint to the user agent about what the author
thinks will lead to the best user experience for media playback. The attribute
may be ignored altogether, for example based on explicit user preferences or
based on the capabilities of the underlying platform.</p>


   <p>The <code><code class="idl"><a data-link-type="idl" href="#dom-htmlmediaelement-kind">kind</a></code></code> IDL attribute can be changed even
once the media resource is being played; but it is only read by the platform at
the point that the <a data-link-type="dfn" href="#media-session-invocation-algorithm">media session invocation algorithm</a> is run against a
<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a>. Thus, changing this attribute once the media element is
<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#potentially-playing">potentially playing</a> does not dynamically change the <a data-link-type="dfn" href="#media-session">media session</a>
to which the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> belongs.</p>


   <p>The <code><code class="idl"><a data-link-type="idl" href="#dom-htmlmediaelement-kind">kind</a></code></code> IDL attribute must
<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#reflect">reflect</a> the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#video">video</a></code> and <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#audio">audio</a></code> element content attribute of the same name, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#limited-to-only-known-values">limited
to only known values</a>.</p>


   <h3 class="heading settled" data-level="7.2" id="video-element-additions"><span class="secno">7.2. </span><span class="content">Additions to the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#video">video</a></code> element</span><a class="self-link" href="#video-element-additions"></a></h3>


   <dl class="element">
  
    <dt>
    Additional content attributes:
  
  
    <dd>
    <dfn data-dfn-type="dfn" data-lt="video kind" data-noexport="" id="video-kind"><code>kind</code><a class="self-link" href="#video-kind"></a></dfn> â€” The type of video
  
</dl>


   <p>The <code><a data-link-type="dfn" href="#video-kind">kind</a></code> content attribute on a
<code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#video">video</a></code> element, is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enumerated-attribute">enumerated attribute</a>
and must return the video elementâ€™s <a data-link-type="dfn" href="#media-category">media category</a>, if it has one, or the
empty string otherwise.</p>


   <h3 class="heading settled" data-level="7.3" id="audio-element-additions"><span class="secno">7.3. </span><span class="content">Additions to the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#audio">audio</a></code> element</span><a class="self-link" href="#audio-element-additions"></a></h3>


   <dl class="element">
  
    <dt>
    Additional content attributes:
  
  
    <dd>
    <dfn data-dfn-type="dfn" data-lt="audio kind" data-noexport="" id="audio-kind"><code>kind</code><a class="self-link" href="#audio-kind"></a></dfn> â€” The type of audio
  
</dl>


   <p>The <code><a data-link-type="dfn" href="#audio-kind">kind</a></code> content attribute on an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#audio">audio</a></code> element, is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#enumerated-attribute">enumerated attribute</a> and must
return the audio elementâ€™s <a data-link-type="dfn" href="#media-category">media category</a>, if it has one, or the empty
string otherwise.</p>


   <h2 class="heading settled" data-level="8" id="invoking-media-session"><span class="secno">8. </span><span class="content">Media Session Invocation</span><a class="self-link" href="#invoking-media-session"></a></h2>


   <p>When a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> transitions to <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#potentially-playing">potentially playing</a> then the
user agent must run the <dfn data-dfn-type="dfn" data-noexport="" id="media-session-invocation-algorithm">media session invocation algorithm<a class="self-link" href="#media-session-invocation-algorithm"></a></dfn> which
consists of the following steps, passing in the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> as
<var>current media element</var>.</p>


   <ol>
  
    <li>
    Let <var>media category state</var> be the <var>current media
    element</var>â€™s <code class="idl"><a data-link-type="idl" href="#dom-htmlmediaelement-kind">kind</a></code> attributeâ€™s state value as defined in the list of
    <a href="#valid-media-categories">possible media categories</a>. If no known
    category match is found, let <var>media category state</var> be <code><a data-link-type="dfn" href="#default-media-state">Default</a></code>.
  
  
    <li>
    Return and run the remaining steps asynchronously.
  
  
    <li>
    Let <var>media session</var> be the current <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">top-level browsing
    context</a>â€™s <a data-link-type="dfn" href="#media-session">media session</a> object that matches <var>media category
    state</var>. If no <var>media session</var> is available in the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">top-level
    browsing context</a> that matches <var>media category state</var> then, let
    <var>media session</var> be a new <a data-link-type="dfn" href="#media-session">media session</a> with a <a data-link-type="dfn" href="#media-category">media
    category</a> set to the value of <var>media category state</var>.


     <p>Optionally, based on platform conventions, when creating a new <var>media
    session</var>, also request the most appropriate platform-level media focus
    for the <var>media session</var> based on the current <var>media category
    state</var>.</p>
     
  
  
    <li>
    Add a reference to the <var>current media element</var> to <var>media
    session</var>â€™s <a data-link-type="dfn" href="#session-media-elements">session media elements</a>.
  
  
    <li>
    Set <var>current media element</var>â€™s <a data-link-type="dfn" href="#current-media-session">current media session</a> to
    <var>media session</var>.
  
  
    <li>
    Run these substeps:

    
     <dl class="switch">
      
      <dt>
        If <var>media category state</var> is <code><a data-link-type="dfn" href="#content-media-state">Content</a></code>
      
      
      
      <dd>
        
       <ol>
          
        <li>
            <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-pause">pause()</a></code> all other <code><a data-link-type="dfn" href="#content-media-state">Content</a></code>-based <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media
            elements</a> in <var>media session</var>.
          
        
          
        <li>
            <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-pause">pause()</a></code> all other <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media elements</a> in
            all other <code><a data-link-type="dfn" href="#content-media-state">Content</a></code>-based
            <a data-link-type="dfn" href="#media-session">media sessions</a> within the user agent.
          
        
          
        <li>
            Optionally, based on platform conventions, the user agent may show
            an ongoing media interface in the underlying platformâ€™s
            notifications area and/or show an ongoing media interface in the
            underlying platformâ€™s lock screen area.
          
        
          
        <li>
            Optionally, based on platform conventions, the user agent may allow
            hardware and/or software media keys to control playback of
            <var>current media element</var>.
          
        
        
       </ol>
       
      
      
      
      <dt>
        If <var>media category state</var> is <code><a data-link-type="dfn" href="#transient-media-state">Transient</a></code>
      
      
      
      <dd>
        
       <ol>
          
        <li>
            For the duration of the <var>current media element</var> duck all
            other
            <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media elements</a> in all other <code><a data-link-type="dfn" href="#content-media-state">Content</a></code>-based <a data-link-type="dfn" href="#media-session">media sessions</a> within the user agent.

            
         <p class="note" role="note">
              The user agent should not provide user access to any hardware or
              software media keys and not display any ongoing media interface in
              the underlying platformâ€™s notifications area or show any ongoing
              media interface in the underlying platformâ€™s lock screen area for
              <code><a data-link-type="dfn" href="#transient-media-state">Transient</a></code>-based
              media elements.
            </p>
         
          
        
        
       </ol>
       
      
      
      
      <dt>
        Otherwise, <var>media category state</var> is <code><a data-link-type="dfn" href="#default-media-state">Default</a></code>
      
      
      
      <dd class="note" role="note">
        @TBW


       <p>Different platforms (e.g. desktop vs. mobile) currently enforce
        different platform-level default behavior for media elements. Should we
        define a consistent behavior across platforms or keep the existing
        defaults per platform? Do the existing defaults continue to make sense
        given the presence of the kind attribute? Can we say something here
        without being overly prescriptive about platform-level default
        conventions?</p>
       
      
      
    
     </dl>
     
  
</ol>


   <h2 class="heading settled" data-level="9" id="interrupting-media-session"><span class="secno">9. </span><span class="content">Media Session Interruption</span><a class="self-link" href="#interrupting-media-session"></a></h2>


   <p class="note" role="note">
  @TBW
</p>




   <h2 class="heading settled" data-level="10" id="terminating-media-session"><span class="secno">10. </span><span class="content">Media Session Termination</span><a class="self-link" href="#terminating-media-session"></a></h2>


   <p>When a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> transitions to no longer be
<a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#potentially-playing">potentially playing</a> nor <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-paused">paused</a> then the user agent must run the
<dfn data-dfn-type="dfn" data-noexport="" id="media-session-termination-algorithm">media session termination algorithm<a class="self-link" href="#media-session-termination-algorithm"></a></dfn> which consists of the following
steps, passing in the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#media-element">media element</a> as <var>current media element</var>.</p>


   <ol>
  
    <li>
    Let <var>media session</var> be the value of <var>current media
    element</var>â€™s' <a data-link-type="dfn" href="#current-media-session">current media session</a>. If <var>current media
    element</var> does not have a <a data-link-type="dfn" href="#current-media-session">current media session</a>, then abort any
    remaining steps and return.
  
  
    <li>
    Return and run the remaining steps asynchronously.
  
  
    <li>
    Remove the reference for the <var>current media element</var> from
    <var>media session</var>â€™s <a data-link-type="dfn" href="#session-media-elements">session media elements</a>.
  
  
    <li>
    Remove <a data-link-type="dfn" href="#current-media-session">current media session</a> from <var>current media element</var>.
  
  
    <li>
    Optionally, based on platform conventions, remove any previously obtained
    platform-level media focus for <var>media session</var> based on the current
    <var>media category state</var>.
  
  
    <li>
    Optionally, based on platform conventions, the user agent must remove any
    previously established ongoing media interface in the underlying platformâ€™s
    notifications area and any ongoing media interface in the underlying
    platformâ€™s lock screen area, if any.
  
  
    <li>
    Optionally, based on platform conventions, the user agent must prevent any
    hardware and/or software media keys from controlling playback of
    <var>current media element</var>.
  
</ol>

</main>
  


  <h2 class="no-num heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="indexlist">
   <li>audio kind, <a href="#audio-kind">7.3</a>
   <li>content attribute value, <a href="#content-attribute-value">5</a>
   <li>content media state, <a href="#content-media-state">5</a>
   <li>current media session, <a href="#current-media-session">6</a>
   <li>default media state, <a href="#default-media-state">5</a>
   <li>kind, <a href="#dom-htmlmediaelement-kind">7.1</a>
   <li>media category, <a href="#media-category">5</a>
   <li>media session, <a href="#media-session">6</a>
   <li>media session invocation algorithm, <a href="#media-session-invocation-algorithm">8</a>
   <li>media session termination algorithm, <a href="#media-session-termination-algorithm">10</a>
   <li>session media elements, <a href="#session-media-elements">6</a>
   <li>transient attribute
      value, <a href="#transient-attribute-value">5</a>
   <li>transient media state, <a href="#transient-media-state">5</a>
   <li>video kind, <a href="#video-kind">7.2</a></ul>
  <h2 class="no-num heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-webidl"><a class="self-link" href="#biblio-webidl"></a>[WebIDL]
   <dd>Cameron McCormack. <a href="https://heycam.github.io/webidl/">Web IDL</a>. 19 April 2012. CR. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
   <dt id="biblio-rfc2119"><a class="self-link" href="#biblio-rfc2119"></a>[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a></dl>
  <script>self = (typeof window !== 'undefined')
	? window   // if in browser
	: (
		(typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)
		? self // if in worker
		: {}   // if in node js
	);

/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 * MIT license http://www.opensource.org/licenses/mit-license.php/
 * @author Lea Verou http://lea.verou.me
 */

var Prism = (function(){

// Private helper vars
var lang = /\blang(?:uage)?-(?!\*)(\w+)\b/i;

var _ = self.Prism = {
	util: {
		encode: function (tokens) {
			if (tokens instanceof Token) {
				return new Token(tokens.type, _.util.encode(tokens.content), tokens.alias);
			} else if (_.util.type(tokens) === 'Array') {
				return tokens.map(_.util.encode);
			} else {
				return tokens.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/\u00a0/g, ' ');
			}
		},

		type: function (o) {
			return Object.prototype.toString.call(o).match(/\[object (\w+)\]/)[1];
		},

		// Deep clone a language definition (e.g. to extend it)
		clone: function (o) {
			var type = _.util.type(o);

			switch (type) {
				case 'Object':
					var clone = {};

					for (var key in o) {
						if (o.hasOwnProperty(key)) {
							clone[key] = _.util.clone(o[key]);
						}
					}

					return clone;

				case 'Array':
					return o.slice();
			}

			return o;
		}
	},

	languages: {
		extend: function (id, redef) {
			var lang = _.util.clone(_.languages[id]);

			for (var key in redef) {
				lang[key] = redef[key];
			}

			return lang;
		},

		// Insert a token before another token in a language literal
		insertBefore: function (inside, before, insert, root) {
			root = root || _.languages;
			var grammar = root[inside];
			var ret = {};

			for (var token in grammar) {

				if (grammar.hasOwnProperty(token)) {

					if (token == before) {

						for (var newToken in insert) {

							if (insert.hasOwnProperty(newToken)) {
								ret[newToken] = insert[newToken];
							}
						}
					}

					ret[token] = grammar[token];
				}
			}

			return root[inside] = ret;
		},

		// Traverse a language definition with Depth First Search
		DFS: function(o, callback, type) {
			for (var i in o) {
				if (o.hasOwnProperty(i)) {
					callback.call(o, i, o[i], type || i);

					if (_.util.type(o[i]) === 'Object') {
						_.languages.DFS(o[i], callback);
					} else if (_.util.type(o[i]) === 'Array') {
						_.languages.DFS(o[i], callback, i);
					}
				}
			}
		}
	},

	highlightAll: function(async, callback) {
		var elements = document.querySelectorAll('code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code');
		for (var i=0, element; element = elements[i++];) {
			if (element.classList.contains("idl")) {
				// Bikeshed handles IDL blocks already.
				continue;
			}
			_.highlightElement(element, async === true, callback);
		}

		var elements = document.querySelectorAll('pre[class*="language-"], [class*="language-"] pre, pre[class*="lang-"], [class*="lang-"] pre');
		for (var i=0, element; element = elements[i++];) {
			if (element.firstElementChild && element.firstElementChild.tagName.toLowerCase() == "code") {
				// Already handled by the previous loop
				continue;
			}
			if (element.classList.contains("idl")) {
				// Bikeshed handles IDL blocks already.
				continue;
			}
			_.highlightElement(element, async === true, callback);
		}
	},

	highlightElement: function(element, async, callback) {
		// Find language
		var language, grammar, parent = element;

		while (parent && !lang.test(parent.className)) {
			parent = parent.parentNode;
		}

		if (parent) {
			language = (parent.className.match(lang) || [,''])[1];
			grammar = _.languages[language];
		}

		if (!grammar) {
			return;
		}

		// Set language on the element, if not present
		element.className = element.className.replace(lang, '').replace(/\s+/g, ' ') + ' language-' + language;

		// Set language on the parent, for styling
		parent = element.parentNode;

		if (/pre/i.test(parent.nodeName)) {
			parent.className = parent.className.replace(lang, '').replace(/\s+/g, ' ') + ' language-' + language;
		}

		var code = element.textContent;

		if(!code) {
			return;
		}

		var env = {
			element: element,
			language: language,
			grammar: grammar,
			code: code
		};

		_.hooks.run('before-highlight', env);

		if (async && self.Worker) {
			var worker = new Worker(_.filename);

			worker.onmessage = function(evt) {
				env.highlightedCode = Token.stringify(JSON.parse(evt.data), language);

				_.hooks.run('before-insert', env);

				env.element.innerHTML = env.highlightedCode;

				callback && callback.call(env.element);
				_.hooks.run('after-highlight', env);
			};

			worker.postMessage(JSON.stringify({
				language: env.language,
				code: env.code
			}));
		}
		else {
			env.highlightedCode = _.highlight(env.code, env.grammar, env.language)

			_.hooks.run('before-insert', env);

			env.element.innerHTML = env.highlightedCode;

			callback && callback.call(element);

			_.hooks.run('after-highlight', env);
		}
	},

	highlight: function (text, grammar, language) {
		var tokens = _.tokenize(text, grammar);
		return Token.stringify(_.util.encode(tokens), language);
	},

	tokenize: function(text, grammar, language) {
		var Token = _.Token;

		var strarr = [text];

		var rest = grammar.rest;

		if (rest) {
			for (var token in rest) {
				grammar[token] = rest[token];
			}

			delete grammar.rest;
		}

		tokenloop: for (var token in grammar) {
			if(!grammar.hasOwnProperty(token) || !grammar[token]) {
				continue;
			}

			var patterns = grammar[token];
			patterns = (_.util.type(patterns) === "Array") ? patterns : [patterns];

			for (var j = 0; j < patterns.length; ++j) {
				var pattern = patterns[j],
					inside = pattern.inside,
					lookbehind = !!pattern.lookbehind,
					lookbehindLength = 0,
					alias = pattern.alias;

				pattern = pattern.pattern || pattern;

				for (var i=0; i<strarr.length; i++) { // Donâ€™t cache length as it changes during the loop

					var str = strarr[i];

					if (strarr.length > text.length) {
						// Something went terribly wrong, ABORT, ABORT!
						break tokenloop;
					}

					if (str instanceof Token) {
						continue;
					}

					pattern.lastIndex = 0;

					var match = pattern.exec(str);

					if (match) {
						if(lookbehind) {
							lookbehindLength = match[1].length;
						}

						var from = match.index - 1 + lookbehindLength,
							match = match[0].slice(lookbehindLength),
							len = match.length,
							to = from + len,
							before = str.slice(0, from + 1),
							after = str.slice(to + 1);

						var args = [i, 1];

						if (before) {
							args.push(before);
						}

						var wrapped = new Token(token, inside? _.tokenize(match, inside) : match, alias);

						args.push(wrapped);

						if (after) {
							args.push(after);
						}

						Array.prototype.splice.apply(strarr, args);
					}
				}
			}
		}

		return strarr;
	},

	hooks: {
		all: {},

		add: function (name, callback) {
			var hooks = _.hooks.all;

			hooks[name] = hooks[name] || [];

			hooks[name].push(callback);
		},

		run: function (name, env) {
			var callbacks = _.hooks.all[name];

			if (!callbacks || !callbacks.length) {
				return;
			}

			for (var i=0, callback; callback = callbacks[i++];) {
				callback(env);
			}
		}
	}
};

var Token = _.Token = function(type, content, alias) {
	this.type = type;
	this.content = content;
	this.alias = alias;
};

Token.stringify = function(o, language, parent) {
	if (typeof o == 'string') {
		return o;
	}

	if (Object.prototype.toString.call(o) == '[object Array]') {
		return o.map(function(element) {
			return Token.stringify(element, language, o);
		}).join('');
	}

	var env = {
		type: o.type,
		content: Token.stringify(o.content, language, parent),
		tag: 'span',
		classes: ['token', o.type],
		attributes: {},
		language: language,
		parent: parent
	};

	if (env.type == 'comment') {
		env.attributes['spellcheck'] = 'true';
	}

	if (o.alias) {
		var aliases = _.util.type(o.alias) === 'Array' ? o.alias : [o.alias];
		Array.prototype.push.apply(env.classes, aliases);
	}

	_.hooks.run('wrap', env);

	var attributes = '';

	for (var name in env.attributes) {
		attributes += name + '="' + (env.attributes[name] || '') + '"';
	}

	return '<' + env.tag + ' class="' + env.classes.join(' ') + '" ' + attributes + '>' + env.content + '</' + env.tag + '>';

};

if (!self.document) {
	if (!self.addEventListener) {
		// in Node.js
		return self.Prism;
	}
 	// In worker
	self.addEventListener('message', function(evt) {
		var message = JSON.parse(evt.data),
		    lang = message.language,
		    code = message.code;

		self.postMessage(JSON.stringify(_.util.encode(_.tokenize(code, _.languages[lang]))));
		self.close();
	}, false);

	return self.Prism;
}

// Get current script and highlight
var script = document.getElementsByTagName('script');

script = script[script.length - 1];

if (script) {
	_.filename = script.src;

	if (document.addEventListener && !script.hasAttribute('data-manual')) {
		document.addEventListener('DOMContentLoaded', _.highlightAll);
	}
}

return self.Prism;

})();

if (typeof module !== 'undefined' && module.exports) {
	module.exports = Prism;
}
;
Prism.languages.clike = {
	'comment': [
		{
			pattern: /(^|[^\\])\/\*[\w\W]*?\*\//g,
			lookbehind: true
		},
		{
			pattern: /(^|[^\\:])\/\/.*?(\r?\n|$)/g,
			lookbehind: true
		}
	],
	'string': /("|')(\\?.)*?\1/g,
	'class-name': {
		pattern: /((?:(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/ig,
		lookbehind: true,
		inside: {
			punctuation: /(\.|\\)/
		}
	},
	'keyword': /\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/g,
	'boolean': /\b(true|false)\b/g,
	'function': {
		pattern: /[a-z0-9_]+\(/ig,
		inside: {
			punctuation: /\(/
		}
	},
	'number': /\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?)\b/g,
	'operator': /[-+]{1,2}|!|<=?|>=?|={1,3}|&{1,2}|\|?\||\?|\*|\/|\~|\^|\%/g,
	'ignore': /&(lt|gt|amp);/gi,
	'punctuation': /[{}[\];(),.:]/g
};
;
Prism.languages.markup = {
	'comment': /<!--[\w\W]*?-->/g,
	'prolog': /<\?.+?\?>/,
	'doctype': /<!DOCTYPE.+?>/,
	'cdata': /<!\[CDATA\[[\w\W]*?]]>/i,
	'tag': {
		pattern: /<\/?[\w:-]+\s*(?:\s+[\w:-]+(?:=(?:("|')(\\?[\w\W])*?\1|[^\s'">=]+))?\s*)*\/?>/gi,
		inside: {
			'tag': {
				pattern: /^<\/?[\w:-]+/i,
				inside: {
					'punctuation': /^<\/?/,
					'namespace': /^[\w-]+?:/
				}
			},
			'attr-value': {
				pattern: /=(?:('|")[\w\W]*?(\1)|[^\s>]+)/gi,
				inside: {
					'punctuation': /=|>|"/g
				}
			},
			'punctuation': /\/?>/g,
			'attr-name': {
				pattern: /[\w:-]+/g,
				inside: {
					'namespace': /^[\w-]+?:/
				}
			}

		}
	},
	'entity': /\&#?[\da-z]{1,8};/gi
};

// Plugin to make entity title show the real entity, idea by Roman Komarov
Prism.hooks.add('wrap', function(env) {

	if (env.type === 'entity') {
		env.attributes['title'] = env.content.replace(/&amp;/, '&');
	}
});
;
Prism.languages.javascript = Prism.languages.extend('clike', {
	'keyword': /\b(break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|false|finally|for|function|get|if|implements|import|in|instanceof|interface|let|new|null|package|private|protected|public|return|set|static|super|switch|this|throw|true|try|typeof|var|void|while|with|yield)\b/g,
	'number': /\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?|NaN|-?Infinity)\b/g
});

Prism.languages.insertBefore('javascript', 'keyword', {
	'regex': {
		pattern: /(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/g,
		lookbehind: true
	}
});

if (Prism.languages.markup) {
	Prism.languages.insertBefore('markup', 'tag', {
		'script': {
			pattern: /<script[\w\W]*?>[\w\W]*?<\/script>/ig,
			inside: {
				'tag': {
					pattern: /<script[\w\W]*?>|<\/script>/ig,
					inside: Prism.languages.markup.tag.inside
				},
				rest: Prism.languages.javascript
			}
		}
	});
}
;
</script>
 </body>
</html>